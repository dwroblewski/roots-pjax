/**
 * Roots PJAX
 * WordPress meets HTML5 Boilerplate, Bootstrap, and PJAX
 * https://github.com/wayoutmind/roots-pjax
 */(function(e){e(document).ready(function(){if(Modernizr.history){var t=Crackle.not;e("a:not(:has(img))").pjax("#wrap",{timeout:2e3}),e.ajaxPrefilter(function(e,t,n){n.url=t.url}),e(document).bind("pjax:beforeSend",function(t,n){var r=new XMLHttpRequest;r.open("HEAD",n.url,!1),r.setRequestHeader("X-PJAX",!0),r.send();var i=r.getResponseHeader("Content-Type").indexOf("text/html")!==-1,s=r.getResponseHeader("X-PJAX")!=="false";if(i&&s){var o=["current-menu-item","current-menu-parent","current-menu-ancestor","current_page_item","current_page_parent","current_page_ancestor"].join(" ");e(".active").removeClass(o);while(e(".active").length>0)e(".active").removeClass("active");return e(t.relatedTarget).parent().addClass("active"),!0}n.abort(),window.location.href=n.url}),e(document).bind("pjax:start",function(){e(this).ajaxSuccess(function(n,r,i){var s=r.getResponseHeader("X-WordPress-Body-Class");e(this).attr("class",s);var o={canonical:r.getResponseHeader("X-WordPress-Link-Canonical"),previous:r.getResponseHeader("X-WordPress-Link-Previous"),next:r.getResponseHeader("X-WordPress-Link-Next")},u={previous:r.getResponseHeader("X-WordPress-Title-Previous"),next:r.getResponseHeader("X-WordPress-Title-Next")};e('link[rel="canonical"]').attr("href",o.canonical),e('link[rel="prev"]').attr("href",o.previous),e('link[rel="prev"]').attr("title",u.previous),e('link[rel="prev"]').length===0&&e("head").append('<link rel="previous" title="'+u.previous+'" href="'+o.previous+'" />'),e('link[rel="next"]').attr("href",o.next),e('link[rel="next"]').attr("title",u.next),e('link[rel="next"]').length===0&&e("head").append('<link rel="previous" title="'+u.next+'" href="'+o.next+'" />');var a={before:Crackle.stringify(e.makeArray(e("head").children())).map(function(e){return e.replace(/(\r\n|\n|\r|\t)/gm,"")}),after:Crackle.stringify(e.makeArray(e(JSON.parse(r.getResponseHeader("X-WordPress-Head")).replace(/(\r\n|\n|\r|\t)/gm,""))))};a.diff=t(a.after).in(a.before);for(var f=0;f<a.diff.length;f++){var l="#"+e(a.diff[f]).attr("id");e(l).length>0?(e(l).remove(),e("head").append(a.diff[f])):e("head").append(c.diff[f])}var c={before:Crackle.stringify(e.makeArray(e("footer").nextAll())).map(function(e){return e.replace(/(\r\n|\n|\r|\t)/gm,"")}),after:Crackle.stringify(e.makeArray(e(JSON.parse(r.getResponseHeader("X-WordPress-Footer")).replace(/(\r\n|\n|\r|\t)/gm,""))))};c.diff=t(c.after).in(c.before).map(function(t){return e(t).attr("id")==="wpadminbar"?Crackle.stringify(e(t).removeClass()):t});for(var f=0;f<c.diff.length;f++){var l="#"+e(c.diff[f]).attr("id");e(l).length>0?(e(l).remove(),e("body").append(c.diff[f])):e("body").append(c.diff[f])}})})}})})(jQuery);
